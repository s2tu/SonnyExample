package com.training.utils;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import com.domains.Donor;

import interfaces.MyDAO;

public class DonorDAO implements MyDAO<Donor>{
	private Connection con = null;
	
	/**
	 *get the default connection
	 */
	public DonorDAO() {
		super();
		this.con = MySQLConnection.getMyoracleConnection();
	}
	
	/**
	 * @param con
	 */
	public DonorDAO(Connection con) {
		super();
		this.con = con;
	}

	@Override
	public int add(Donor d) {
		// TODO Auto-generated method stub
		int rowAdded = 0;
		
		String sqlAdd = "insert into donors values(?, ? ,?, ?)";
		try{
			PreparedStatement prepareStatment  =  this.con.prepareStatement(sqlAdd);
			/*
			  private long donorCode;
			  private String donorName;
			  private long handPhone;
			  private String email;*/
			prepareStatment.setLong(1, d.getDonorCode());
			prepareStatment.setString(2, d.getDonorName());
			prepareStatment.setLong(3, d.getHandPhone());
			prepareStatment.setString(4, d.getEmail());
			rowAdded = prepareStatment.executeUpdate();
			return rowAdded;
		}catch(SQLException e){
			e.printStackTrace();
		}
		return rowAdded;
	}

	@Override
	public int update(long donorCode) {
		// TODO Auto-generated method stub
		return 0;
	}

	@Override
	public int delete(long donorCode) {
		// TODO Auto-generated method stub
		return 0;
	}

	@Override
	public List<Donor> findAll() {
		ArrayList<Donor> donorList =  new ArrayList<Donor>();
		String queryString = "select * from donors";
		try{
			PreparedStatement prepareStatement = this.con.prepareStatement(queryString);
			ResultSet allDonors = prepareStatement.executeQuery(); 
			while(allDonors.next()){
				donorList.add(new Donor(allDonors.getLong(1), allDonors.getString(2), allDonors.getLong(3), allDonors.getString(4)));
			}
			return donorList;
		}catch(Exception e){
			e.printStackTrace();
		}
		// TODO Auto-generated method stub
		return null;
	}

}
